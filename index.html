<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kunlik Reja - Biznes Planner v1.1.0</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
        body { font-family: 'Inter', sans-serif; margin: 0; padding: 0; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useRef, useEffect } = React;
        
        // Icons
        const Target = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
                <circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/>
            </svg>
        );
        const CheckCircle = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/>
            </svg>
        );
        const Calendar = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/>
            </svg>
        );
        const Clock = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
                <circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/>
            </svg>
        );
        const Download = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/>
            </svg>
        );
        const X = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
                <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
            </svg>
        );
        const ZoomIn = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
                <circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/><line x1="11" y1="8" x2="11" y2="14"/><line x1="8" y1="11" x2="14" y2="11"/>
            </svg>
        );
        const ZoomOut = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
                <circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/><line x1="8" y1="11" x2="14" y2="11"/>
            </svg>
        );
        const Home = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
                <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/>
            </svg>
        );
        const Link2 = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
                <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"/><line x1="8" y1="12" x2="16" y2="12"/>
            </svg>
        );
        const Trash2 = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
                <polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/><line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/>
            </svg>
        );
        const Bell = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
                <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/>
            </svg>
        );
        const BarChart = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
                <line x1="12" y1="20" x2="12" y2="10"/><line x1="18" y1="20" x2="18" y2="4"/><line x1="6" y1="20" x2="6" y2="16"/>
            </svg>
        );
        const Eye = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/>
            </svg>
        );
        const Moon = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
            </svg>
        );
        const Sun = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
                <circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
            </svg>
        );

        function MindMap() {
            const VERSION = "v1.1.0";
            const [currentDate] = useState(new Date('2024-10-20T19:39:00'));
            const [showToday, setShowToday] = useState(false);
            const [showStats, setShowStats] = useState(false);
            const [focusMode, setFocusMode] = useState(false);
            const [darkMode, setDarkMode] = useState(true);
            const [notificationsEnabled, setNotificationsEnabled] = useState(false);
            
            const dailyTasks = [
                { date: '2024-10-20', tasks: [
                    { text: '20 kartochka yaxshilash', color: '#F59E0B', category: 'Yandex' },
                    { text: '200 mahsulot yuklash', color: '#10B981', category: 'Yandex' },
                    { text: 'Rasmlarni tekshirish', color: '#34D399', category: 'Yandex' }
                ]},
                { date: '2024-10-21', tasks: [
                    { text: '20 kartochka yaxshilash', color: '#F59E0B', category: 'Yandex' },
                    { text: '200 mahsulot yuklash', color: '#10B981', category: 'Yandex' },
                    { text: 'Magazin dizayni boshlash', color: '#A78BFA', category: 'Magazin' }
                ]},
                { date: '2024-10-22', tasks: [
                    { text: '20 kartochka yaxshilash', color: '#F59E0B', category: 'Yandex' },
                    { text: '200 mahsulot yuklash', color: '#10B981', category: 'Yandex' },
                    { text: 'Frontend tayyor qilish', color: '#A78BFA', category: 'Magazin' }
                ]},
                { date: '2024-11-08', tasks: [
                    { text: 'BARCHA LOYIHALAR TEKSHIRISH', color: '#DC2626', category: 'Muhim' },
                    { text: 'Yandex Market - final', color: '#F59E0B', category: 'Yandex' },
                    { text: 'üéâüéâüéâ TAYYOR! üéâüéâüéâ', color: '#DC2626', category: 'Muhim' }
                ]}
            ];
          // Notifications
            useEffect(() => {
                if (notificationsEnabled && 'Notification' in window) {
                    Notification.requestPermission();
                }
            }, [notificationsEnabled]);

            const sendNotification = (title, body) => {
                if (notificationsEnabled && Notification.permission === 'granted') {
                    new Notification(title, { body });
                }
            };

            useEffect(() => {
                const checkTime = setInterval(() => {
                    const now = new Date();
                    const hour = now.getHours();
                    const minute = now.getMinutes();
                    if (hour === 9 && minute === 0) {
                        const todayTasks = getTodayTasks();
                        sendNotification('‚òÄÔ∏è Yaxshi tong!', `Bugun ${todayTasks.length} ta vazifa bor!`);
                    }
                    if (hour === 20 && minute === 0) {
                        const todayTasks = getTodayTasks();
                        const remaining = todayTasks.filter(t => !t.done).length;
                        if (remaining > 0) {
                            sendNotification('‚è∞ Eslatma!', `${remaining} ta vazifa bajarilmagan!`);
                        }
                    }
                }, 60000);
                return () => clearInterval(checkTime);
            }, [notificationsEnabled]);

            const createNodesFromDailyTasks = () => {
                const savedData = localStorage.getItem('mindMapData');
                if (savedData) return JSON.parse(savedData);
                const allNodes = [];
                const allLinks = [];
                let nodeId = 1;
                allNodes.push({ id: nodeId++, x: 700, y: 50, text: 'üéØ 8-NOYABR TAYYOR', color: '#DC2626', type: 'main', done: false, date: null });
                allNodes.push({ id: nodeId++, x: 150, y: 200, text: 'üî• YANDEX', color: '#DC2626', type: 'main', done: false, date: null });
                allNodes.push({ id: nodeId++, x: 700, y: 200, text: 'üåê MAGAZIN', color: '#8B5CF6', type: 'main', done: false, date: null });
                allNodes.push({ id: nodeId++, x: 1250, y: 200, text: 'üì± TELEGRAM', color: '#0EA5E9', type: 'main', done: false, date: null });
                dailyTasks.forEach((day, dayIndex) => {
                    const xOffset = 100 + (dayIndex % 5) * 280;
                    const yOffsetDay = 320 + Math.floor(dayIndex / 5) * 200;
                    day.tasks.forEach((task, taskIndex) => {
                        const fullText = `üìÖ ${day.date.slice(5)}: ${task.text}`;
                        allNodes.push({
                            id: nodeId,
                            x: xOffset,
                            y: yOffsetDay + taskIndex * 50,
                            text: fullText,
                            color: task.color,
                            type: 'day',
                            done: false,
                            date: day.date,
                            category: task.category
                        });
                        nodeId++;
                    });
                });
                return { nodes: allNodes, links: allLinks };
            };

            const initialData = createNodesFromDailyTasks();
            const [nodes, setNodes] = useState(initialData.nodes);
            const [links, setLinks] = useState(initialData.links);
            const [selected, setSelected] = useState(null);
            const [dragging, setDragging] = useState(null);
            const [linking, setLinking] = useState(null);
            const [offset, setOffset] = useState({ x: 0, y: 0 });
            const [editing, setEditing] = useState(null);
            const [nextId, setNextId] = useState(1000);
            const [viewport, setViewport] = useState({ x: 0, y: 0, zoom: 0.7 });
            const [isPanning, setIsPanning] = useState(false);
            const [panStart, setPanStart] = useState({ x: 0, y: 0 });
            const canvasRef = useRef(null);

            useEffect(() => {
                localStorage.setItem('mindMapData', JSON.stringify({ nodes, links }));
            }, [nodes, links]);

            const getTodayTasks = () => {
                const today = currentDate.toISOString().split('T')[0];
                return nodes.filter(n => n.date === today);
            };

            const types = [
                { type: 'main', color: '#8B5CF6', label: 'Asosiy maqsad' },
                { type: 'day', color: '#F59E0B', label: 'Kunlik vazifa' }
            ];

            const addNode = (type) => {
                const t = types.find(x => x.type === type);
                const centerX = (window.innerWidth / 2 - viewport.x) / viewport.zoom;
                const centerY = (window.innerHeight / 2 - viewport.y) / viewport.zoom;
                setNodes([...nodes, {
                    id: nextId,
                    x: centerX,
                    y: centerY,
                    text: t.label,
                    color: t.color,
                    type,
                    done: false,
                    date: type === 'day' ? currentDate.toISOString().split('T')[0] : null
                }]);
                setNextId(nextId + 1);
            };

            const deleteNode = () => {
                if (selected) {
                    setNodes(nodes.filter(n => n.id !== selected));
                    setLinks(links.filter(l => l.from !== selected && l.to !== selected));
                    setSelected(null);
                }
            };

            const startLink = () => {
                if (selected) setLinking(selected);
            };

            const completeLink = (toId) => {
                if (linking && linking !== toId && !links.find(l => 
                    (l.from === linking && l.to === toId) || (l.from === toId && l.to === linking)
                )) {
                    setLinks([...links, { from: linking, to: toId }]);
                }
                setLinking(null);
            };

            const toggle = (id) => {
                setNodes(nodes.map(n => n.id === id ? { ...n, done: !n.done } : n));
            };

            const updateText = (id, text) => {
                setNodes(nodes.map(n => n.id === id ? { ...n, text } : n));
            };

            const zoomIn = () => setViewport(v => ({ ...v, zoom: Math.min(v.zoom * 1.2, 2) }));
            const zoomOut = () => setViewport(v => ({ ...v, zoom: Math.max(v.zoom / 1.2, 0.3) }));
            const resetView = () => setViewport({ x: 0, y: 0, zoom: 0.7 });

            const exportData = () => {
                const blob = new Blob([JSON.stringify({ nodes, links }, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `kunlik-reja-${Date.now()}.json`;
                a.click();
            };

            const handleCanvasMouseDown = (e) => {
                if (e.target.tagName === 'CANVAS' || e.target.className.includes('bg-gradient')) {
                    setIsPanning(true);
                    setPanStart({ x: e.clientX - viewport.x, y: e.clientY - viewport.y });
                }
            };

            const handleMouseMove = (e) => {
                if (dragging) {
                    const worldX = (e.clientX - viewport.x) / viewport.zoom;
                    const worldY = (e.clientY - viewport.y) / viewport.zoom;
                    setNodes(nodes.map(n => 
                        n.id === dragging ? { ...n, x: worldX - offset.x, y: worldY - offset.y } : n
                    ));
                } else if (isPanning) {
                    setViewport(v => ({ ...v, x: e.clientX - panStart.x, y: e.clientY - panStart.y }));
                }
            };

            const handleMouseUp = () => {
                setDragging(null);
                setIsPanning(false);
            };

            const handleWheel = (e) => {
                e.preventDefault();
                const delta = e.deltaY > 0 ? 0.9 : 1.1;
                setViewport(v => ({ ...v, zoom: Math.max(0.3, Math.min(2, v.zoom * delta)) }));
            };

            useEffect(() => {
                const ctx = canvasRef.current?.getContext('2d');
                if (!ctx) return;
                ctx.canvas.width = window.innerWidth;
                ctx.canvas.height = window.innerHeight;
                ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
                ctx.save();
                ctx.translate(viewport.x, viewport.y);
                ctx.scale(viewport.zoom, viewport.zoom);
                links.forEach(l => {
                    const from = nodes.find(n => n.id === l.from);
                    const to = nodes.find(n => n.id === l.to);
                    if (!from || !to) return;
                    const gradient = ctx.createLinearGradient(from.x + 90, from.y + 25, to.x + 90, to.y + 25);
                    gradient.addColorStop(0, '#8B5CF6');
                    gradient.addColorStop(1, '#06B6D4');
                    ctx.beginPath();
                    ctx.moveTo(from.x + 90, from.y + 25);
                    ctx.lineTo(to.x + 90, to.y + 25);
                    ctx.strokeStyle = gradient;
                    ctx.lineWidth = 3;
                    ctx.shadowColor = '#8B5CF6';
                    ctx.shadowBlur = 10;
                    ctx.stroke();
                    ctx.shadowBlur = 0;
                    const angle = Math.atan2(to.y - from.y, to.x - from.x);
                    ctx.beginPath();
                    ctx.moveTo(to.x + 90, to.y + 25);
                    ctx.lineTo(to.x + 90 - 10 * Math.cos(angle - 0.4), to.y + 25 - 10 * Math.sin(angle - 0.4));
                    ctx.lineTo(to.x + 90 - 10 * Math.cos(angle + 0.4), to.y + 25 - 10 * Math.sin(angle + 0.4));
                    ctx.closePath();
                    ctx.fillStyle = '#06B6D4';
                    ctx.fill();
                });
                ctx.restore();
            }, [nodes, links, viewport]);

            const stats = { total: nodes.length, done: nodes.filter(n => n.done).length };
            const todayTasks = getTodayTasks();
            const daysLeft = 19;
            const bgClass = darkMode ? 'bg-gradient-to-br from-slate-950 via-purple-950 to-slate-950' : 'bg-gradient-to-br from-blue-400 via-purple-400 to-pink-400';
          return (
                <div className={`${bgClass} min-h-screen w-full overflow-hidden relative`}
                     onMouseMove={handleMouseMove}
                     onMouseUp={handleMouseUp}
                     onWheel={handleWheel}>
                    
                    {/* Header */}
                    <div className={`fixed top-0 left-0 right-0 ${darkMode ? 'bg-slate-900/80' : 'bg-white/80'} backdrop-blur-md border-b ${darkMode ? 'border-purple-500/30' : 'border-purple-300'} z-50 shadow-lg`}>
                        <div className="flex items-center justify-between px-6 py-4">
                            <div className="flex items-center gap-4">
                                <h1 className={`text-2xl font-bold ${darkMode ? 'text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-cyan-400' : 'text-purple-600'}`}>
                                    üéØ Kunlik Reja
                                </h1>
                                <span className={`text-sm px-3 py-1 rounded-full ${darkMode ? 'bg-purple-500/20 text-purple-300' : 'bg-purple-100 text-purple-600'}`}>
                                    {VERSION}
                                </span>
                            </div>
                            
                            <div className="flex items-center gap-2">
                                {/* Dark/Light Mode */}
                                <button onClick={() => setDarkMode(!darkMode)}
                                        className={`p-2 rounded-lg ${darkMode ? 'bg-slate-800 hover:bg-slate-700 text-yellow-400' : 'bg-purple-100 hover:bg-purple-200 text-purple-600'} transition-all`}>
                                    {darkMode ? <Sun size={20} /> : <Moon size={20} />}
                                </button>
                                
                                {/* Notifications */}
                                <button onClick={() => {
                                    setNotificationsEnabled(!notificationsEnabled);
                                    if (!notificationsEnabled && 'Notification' in window) {
                                        Notification.requestPermission();
                                    }
                                }}
                                        className={`p-2 rounded-lg ${notificationsEnabled ? 'bg-green-500/20 text-green-400' : darkMode ? 'bg-slate-800 hover:bg-slate-700 text-gray-400' : 'bg-purple-100 hover:bg-purple-200 text-purple-600'} transition-all`}>
                                    <Bell size={20} />
                                </button>
                                
                                {/* Statistics */}
                                <button onClick={() => setShowStats(!showStats)}
                                        className={`p-2 rounded-lg ${darkMode ? 'bg-slate-800 hover:bg-slate-700 text-cyan-400' : 'bg-purple-100 hover:bg-purple-200 text-purple-600'} transition-all`}>
                                    <BarChart size={20} />
                                </button>
                                
                                {/* Focus Mode */}
                                <button onClick={() => setFocusMode(!focusMode)}
                                        className={`p-2 rounded-lg ${focusMode ? 'bg-blue-500/20 text-blue-400' : darkMode ? 'bg-slate-800 hover:bg-slate-700 text-gray-400' : 'bg-purple-100 hover:bg-purple-200 text-purple-600'} transition-all`}>
                                    <Eye size={20} />
                                </button>
                                
                                {/* Today Tasks Button */}
                                <button onClick={() => setShowToday(!showToday)}
                                        className={`px-4 py-2 rounded-lg font-semibold ${darkMode ? 'bg-gradient-to-r from-yellow-500 to-orange-500 hover:from-yellow-600 hover:to-orange-600' : 'bg-gradient-to-r from-yellow-400 to-orange-400 hover:from-yellow-500 hover:to-orange-500'} text-white shadow-lg hover:shadow-xl transition-all animate-pulse`}>
                                    üìÖ BUGUNGI VAZIFALAR
                                </button>
                                
                                <div className={`px-4 py-2 rounded-lg ${darkMode ? 'bg-purple-500/20 text-purple-300' : 'bg-purple-100 text-purple-600'}`}>
                                    ‚è∞ {daysLeft} kun qoldi
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Canvas for links */}
                    <canvas ref={canvasRef} className="absolute inset-0 pointer-events-none" />

                    {/* Main Content */}
                    <div className="pt-20" onMouseDown={handleCanvasMouseDown}>
                        {!focusMode ? (
                            <div style={{ transform: `translate(${viewport.x}px, ${viewport.y}px) scale(${viewport.zoom})`, transformOrigin: '0 0' }}>
                                {nodes.map(node => (
                                    <div key={node.id}
                                         className={`absolute p-4 rounded-xl shadow-lg cursor-move transition-all ${
                                             node.done ? 'opacity-50' : ''
                                         } ${
                                             selected === node.id ? 'ring-4 ring-cyan-400 scale-105' : ''
                                         } ${
                                             linking === node.id ? 'ring-4 ring-yellow-400 animate-pulse' : ''
                                         }`}
                                         style={{
                                             left: node.x,
                                             top: node.y,
                                             width: 180,
                                             background: darkMode 
                                                 ? `linear-gradient(135deg, ${node.color}40, ${node.color}20)`
                                                 : `linear-gradient(135deg, ${node.color}60, ${node.color}40)`,
                                             backdropFilter: 'blur(10px)',
                                             border: darkMode ? `2px solid ${node.color}60` : `2px solid ${node.color}80`,
                                         }}
                                         onMouseDown={(e) => {
                                             e.stopPropagation();
                                             if (linking) {
                                                 completeLink(node.id);
                                             } else {
                                                 setSelected(node.id);
                                                 setDragging(node.id);
                                                 const worldX = (e.clientX - viewport.x) / viewport.zoom;
                                                 const worldY = (e.clientY - viewport.y) / viewport.zoom;
                                                 setOffset({ x: worldX - node.x, y: worldY - node.y });
                                             }
                                         }}
                                         onDoubleClick={() => setEditing(node.id)}>
                                        
                                        {editing === node.id ? (
                                            <input
                                                autoFocus
                                                value={node.text}
                                                onChange={(e) => updateText(node.id, e.target.value)}
                                                onBlur={() => setEditing(null)}
                                                onKeyDown={(e) => e.key === 'Enter' && setEditing(null)}
                                                className={`w-full px-2 py-1 rounded ${darkMode ? 'bg-slate-800 text-white' : 'bg-white text-gray-800'} text-sm`}
                                            />
                                        ) : (
                                            <div className={`text-sm font-medium ${darkMode ? 'text-white' : 'text-gray-800'}`}>
                                                {node.text}
                                            </div>
                                        )}
                                        
                                        <button onClick={(e) => { e.stopPropagation(); toggle(node.id); }}
                                                className={`mt-2 p-1 rounded ${node.done ? 'bg-green-500' : darkMode ? 'bg-slate-700' : 'bg-gray-200'} hover:bg-green-500 transition-colors`}>
                                            <CheckCircle size={16} className={node.done ? 'text-white' : darkMode ? 'text-gray-400' : 'text-gray-600'} />
                                        </button>
                                    </div>
                                ))}
                            </div>
                        ) : (
                            <div className="flex items-center justify-center min-h-screen">
                                <div className={`${darkMode ? 'bg-slate-900/80' : 'bg-white/80'} backdrop-blur-md rounded-3xl p-8 max-w-2xl w-full shadow-2xl`}>
                                    <h2 className={`text-3xl font-bold mb-6 ${darkMode ? 'text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-cyan-400' : 'text-purple-600'}`}>
                                        üéØ Fokus Rejimi
                                    </h2>
                                    <div className="space-y-4">
                                        {getTodayTasks().map((task, idx) => (
                                            <div key={task.id}
                                                 onClick={() => toggle(task.id)}
                                                 className={`p-6 rounded-xl cursor-pointer transition-all ${
                                                     task.done ? 'opacity-50' : ''
                                                 } ${darkMode ? 'bg-slate-800 hover:bg-slate-700' : 'bg-purple-50 hover:bg-purple-100'}`}
                                                 style={{ borderLeft: `4px solid ${task.color}` }}>
                                                <div className="flex items-center gap-4">
                                                    <div className={`text-2xl font-bold ${darkMode ? 'text-purple-400' : 'text-purple-600'}`}>
                                                        {idx + 1}
                                                    </div>
                                                    <div className="flex-1">
                                                        <div className={`font-medium ${darkMode ? 'text-white' : 'text-gray-800'}`}>
                                                            {task.text}
                                                        </div>
                                                    </div>
                                                    <CheckCircle size={24} className={task.done ? 'text-green-500' : darkMode ? 'text-gray-600' : 'text-gray-400'} />
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>

                    {/* Control Panel */}
                    {!focusMode && (
                        <div className={`fixed left-6 top-24 ${darkMode ? 'bg-slate-900/80' : 'bg-white/80'} backdrop-blur-md rounded-2xl p-4 shadow-2xl space-y-2 z-40`}>
                            {types.map(t => (
                                <button key={t.type} onClick={() => addNode(t.type)}
                                        className={`w-full px-4 py-2 rounded-lg text-sm font-medium ${darkMode ? 'bg-slate-800 hover:bg-slate-700 text-white' : 'bg-purple-50 hover:bg-purple-100 text-purple-600'} transition-all`}
                                        style={{ borderLeft: `4px solid ${t.color}` }}>
                                    {t.label}
                                </button>
                            ))}
                            <hr className={darkMode ? 'border-slate-700' : 'border-purple-200'} />
                            <button onClick={startLink} disabled={!selected}
                                    className={`w-full px-4 py-2 rounded-lg text-sm font-medium ${darkMode ? 'bg-blue-500/20 hover:bg-blue-500/30 text-blue-400' : 'bg-blue-50 hover:bg-blue-100 text-blue-600'} transition-all disabled:opacity-30`}>
                                <Link2 size={16} className="inline mr-2" /> Bog'lash
                            </button>
                            <button onClick={deleteNode} disabled={!selected}
                                    className={`w-full px-4 py-2 rounded-lg text-sm font-medium ${darkMode ? 'bg-red-500/20 hover:bg-red-500/30 text-red-400' : 'bg-red-50 hover:bg-red-100 text-red-600'} transition-all disabled:opacity-30`}>
                                <Trash2 size={16} className="inline mr-2" /> O'chirish
                            </button>
                        </div>
                    )}

                    {/* Zoom Controls */}
                    {!focusMode && (
                        <div className={`fixed right-6 bottom-6 ${darkMode ? 'bg-slate-900/80' : 'bg-white/80'} backdrop-blur-md rounded-2xl p-2 shadow-2xl space-y-2`}>
                            <button onClick={zoomIn} className={`p-3 rounded-lg ${darkMode ? 'bg-slate-800 hover:bg-slate-700 text-white' : 'bg-purple-50 hover:bg-purple-100 text-purple-600'} transition-all`}>
                                <ZoomIn size={20} />
                            </button>
                            <button onClick={zoomOut} className={`p-3 rounded-lg ${darkMode ? 'bg-slate-800 hover:bg-slate-700 text-white' : 'bg-purple-50 hover:bg-purple-100 text-purple-600'} transition-all`}>
                                <ZoomOut size={20} />
                            </button>
                            <button onClick={resetView} className={`p-3 rounded-lg ${darkMode ? 'bg-slate-800 hover:bg-slate-700 text-white' : 'bg-purple-50 hover:bg-purple-100 text-purple-600'} transition-all`}>
                                <Home size={20} />
                            </button>
                            <button onClick={exportData} className={`p-3 rounded-lg ${darkMode ? 'bg-green-500/20 hover:bg-green-500/30 text-green-400' : 'bg-green-50 hover:bg-green-100 text-green-600'} transition-all`}>
                                <Download size={20} />
                            </button>
                        </div>
                    )}
                  {/* Today Tasks Modal */}
                    {showToday && (
                        <div className="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-6"
                             onClick={() => setShowToday(false)}>
                            <div className={`${darkMode ? 'bg-slate-900' : 'bg-white'} rounded-3xl p-8 max-w-2xl w-full shadow-2xl`}
                                 onClick={(e) => e.stopPropagation()}>
                                <div className="flex items-center justify-between mb-6">
                                    <h2 className={`text-3xl font-bold ${darkMode ? 'text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 to-orange-400' : 'text-orange-600'}`}>
                                        üìÖ Bugungi Vazifalar
                                    </h2>
                                    <button onClick={() => setShowToday(false)}
                                            className={`p-2 rounded-lg ${darkMode ? 'bg-slate-800 hover:bg-slate-700 text-white' : 'bg-gray-100 hover:bg-gray-200 text-gray-600'} transition-all`}>
                                        <X size={24} />
                                    </button>
                                </div>
                                
                                <div className={`mb-6 p-4 rounded-xl ${darkMode ? 'bg-slate-800' : 'bg-orange-50'}`}>
                                    <div className="flex items-center justify-between mb-2">
                                        <span className={`text-sm font-medium ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>
                                            Progress
                                        </span>
                                        <span className={`text-sm font-bold ${darkMode ? 'text-orange-400' : 'text-orange-600'}`}>
                                            {todayTasks.filter(t => t.done).length} / {todayTasks.length}
                                        </span>
                                    </div>
                                    <div className={`h-3 rounded-full ${darkMode ? 'bg-slate-700' : 'bg-gray-200'} overflow-hidden`}>
                                        <div className="h-full bg-gradient-to-r from-yellow-500 to-orange-500 transition-all duration-500"
                                             style={{ width: `${todayTasks.length ? (todayTasks.filter(t => t.done).length / todayTasks.length) * 100 : 0}%` }} />
                                    </div>
                                </div>

                                <div className="space-y-3 max-h-96 overflow-y-auto">
                                    {todayTasks.length > 0 ? todayTasks.map((task, idx) => (
                                        <div key={task.id}
                                             onClick={() => toggle(task.id)}
                                             className={`p-4 rounded-xl cursor-pointer transition-all ${
                                                 task.done ? 'opacity-50' : ''
                                             } ${darkMode ? 'bg-slate-800 hover:bg-slate-700' : 'bg-gray-50 hover:bg-gray-100'}`}
                                             style={{ borderLeft: `4px solid ${task.color}` }}>
                                            <div className="flex items-center gap-4">
                                                <div className={`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ${darkMode ? 'bg-slate-700 text-orange-400' : 'bg-orange-100 text-orange-600'}`}>
                                                    {idx + 1}
                                                </div>
                                                <div className="flex-1">
                                                    <div className={`font-medium ${darkMode ? 'text-white' : 'text-gray-800'} ${task.done ? 'line-through' : ''}`}>
                                                        {task.text}
                                                    </div>
                                                    {task.category && (
                                                        <div className={`text-xs mt-1 ${darkMode ? 'text-gray-500' : 'text-gray-500'}`}>
                                                            {task.category}
                                                        </div>
                                                    )}
                                                </div>
                                                <div className={`p-2 rounded-lg ${task.done ? 'bg-green-500' : darkMode ? 'bg-slate-700' : 'bg-gray-200'}`}>
                                                    <CheckCircle size={20} className={task.done ? 'text-white' : darkMode ? 'text-gray-400' : 'text-gray-500'} />
                                                </div>
                                            </div>
                                        </div>
                                    )) : (
                                        <div className={`text-center py-12 ${darkMode ? 'text-gray-500' : 'text-gray-400'}`}>
                                            <Calendar size={48} className="mx-auto mb-4 opacity-50" />
                                            <p>Bugun uchun vazifalar yo'q</p>
                                        </div>
                                    )}
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Statistics Modal */}
                    {showStats && (
                        <div className="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-6"
                             onClick={() => setShowStats(false)}>
                            <div className={`${darkMode ? 'bg-slate-900' : 'bg-white'} rounded-3xl p-8 max-w-2xl w-full shadow-2xl`}
                                 onClick={(e) => e.stopPropagation()}>
                                <div className="flex items-center justify-between mb-6">
                                    <h2 className={`text-3xl font-bold ${darkMode ? 'text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-400' : 'text-blue-600'}`}>
                                        üìä Statistika va Hisobot
                                    </h2>
                                    <button onClick={() => setShowStats(false)}
                                            className={`p-2 rounded-lg ${darkMode ? 'bg-slate-800 hover:bg-slate-700 text-white' : 'bg-gray-100 hover:bg-gray-200 text-gray-600'} transition-all`}>
                                        <X size={24} />
                                    </button>
                                </div>

                                <div className="grid grid-cols-2 gap-4 mb-6">
                                    <div className={`p-6 rounded-xl ${darkMode ? 'bg-gradient-to-br from-purple-500/20 to-purple-500/10' : 'bg-gradient-to-br from-purple-100 to-purple-50'}`}>
                                        <div className={`text-sm font-medium mb-2 ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>
                                            Jami Vazifalar
                                        </div>
                                        <div className={`text-4xl font-bold ${darkMode ? 'text-purple-400' : 'text-purple-600'}`}>
                                            {stats.total}
                                        </div>
                                    </div>
                                    <div className={`p-6 rounded-xl ${darkMode ? 'bg-gradient-to-br from-green-500/20 to-green-500/10' : 'bg-gradient-to-br from-green-100 to-green-50'}`}>
                                        <div className={`text-sm font-medium mb-2 ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>
                                            Bajarilgan
                                        </div>
                                        <div className={`text-4xl font-bold ${darkMode ? 'text-green-400' : 'text-green-600'}`}>
                                            {stats.done}
                                        </div>
                                    </div>
                                </div>

                                <div className={`p-6 rounded-xl ${darkMode ? 'bg-slate-800' : 'bg-gray-50'} mb-6`}>
                                    <div className="flex items-center justify-between mb-3">
                                        <span className={`font-medium ${darkMode ? 'text-white' : 'text-gray-800'}`}>
                                            Umumiy Progress
                                        </span>
                                        <span className={`text-xl font-bold ${darkMode ? 'text-cyan-400' : 'text-blue-600'}`}>
                                            {stats.total ? Math.round((stats.done / stats.total) * 100) : 0}%
                                        </span>
                                    </div>
                                    <div className={`h-4 rounded-full ${darkMode ? 'bg-slate-700' : 'bg-gray-200'} overflow-hidden`}>
                                        <div className="h-full bg-gradient-to-r from-cyan-500 to-blue-500 transition-all duration-500"
                                             style={{ width: `${stats.total ? (stats.done / stats.total) * 100 : 0}%` }} />
                                    </div>
                                </div>

                                {/* Category Stats */}
                                <div className="space-y-3">
                                    <h3 className={`font-semibold ${darkMode ? 'text-white' : 'text-gray-800'} mb-3`}>
                                        Kategoriyalar bo'yicha
                                    </h3>
                                    {['Yandex', 'Magazin', 'Telegram', 'Muhim'].map(cat => {
                                        const catNodes = nodes.filter(n => n.category === cat);
                                        const catDone = catNodes.filter(n => n.done).length;
                                        const catTotal = catNodes.length;
                                        const catPercent = catTotal ? Math.round((catDone / catTotal) * 100) : 0;
                                        
                                        if (catTotal === 0) return null;
                                        
                                        return (
                                            <div key={cat} className={`p-4 rounded-xl ${darkMode ? 'bg-slate-800' : 'bg-gray-50'}`}>
                                                <div className="flex items-center justify-between mb-2">
                                                    <span className={`font-medium ${darkMode ? 'text-white' : 'text-gray-800'}`}>
                                                        {cat}
                                                    </span>
                                                    <span className={`text-sm font-bold ${darkMode ? 'text-cyan-400' : 'text-blue-600'}`}>
                                                        {catDone} / {catTotal} ({catPercent}%)
                                                    </span>
                                                </div>
                                                <div className={`h-2 rounded-full ${darkMode ? 'bg-slate-700' : 'bg-gray-200'} overflow-hidden`}>
                                                    <div className="h-full bg-gradient-to-r from-cyan-500 to-blue-500 transition-all duration-500"
                                                         style={{ width: `${catPercent}%` }} />
                                                </div>
                                            </div>
                                        );
                                    })}
                                </div>

                                <div className={`mt-6 p-4 rounded-xl ${darkMode ? 'bg-gradient-to-r from-yellow-500/20 to-orange-500/20' : 'bg-gradient-to-r from-yellow-100 to-orange-100'}`}>
                                    <div className={`text-center font-medium ${darkMode ? 'text-yellow-400' : 'text-orange-600'}`}>
                                        {stats.done === 0 ? 'üí™ Boshlaymiz! Birinchi vazifani bajaring!' :
                                         stats.done < stats.total / 4 ? 'üëç Yaxshi boshlandi! Davom eting!' :
                                         stats.done < stats.total / 2 ? 'üî• Ajoyib! Yarim yo\'ldan o\'tdingiz!' :
                                         stats.done < stats.total * 3 / 4 ? '‚≠ê Zo\'r! Deyarli tayyor!' :
                                         stats.done < stats.total ? 'üéØ Juda yaxshi! Sal qoldi!' :
                                         'üéâüéâüéâ TABRIKLAYMAN! HAMMASI TAYYOR! üéâüéâüéâ'}
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        ReactDOM.render(<MindMap />, document.getElementById('root'));
    </script>
</body>
</html>
